# Chef Gabbar - Render Deployment Guide

This guide will help you deploy your Chef Gabbar application to Render.

## Prerequisites

1. A GitHub account with your code pushed to a repository
2. A Render account (sign up at https://render.com)
3. Your Stripe Secret Key (for payment processing)

## Deployment Steps

### Option 1: Using render.yaml (Recommended - Automated)

1. **Push your code to GitHub**
   ```bash
   git add .
   git commit -m "Prepare for Render deployment"
   git push origin main
   ```

2. **Create a new Blueprint on Render**
   - Go to https://dashboard.render.com
   - Click "New" â†’ "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect the `render.yaml` file and set up:
     - PostgreSQL database (chefgabbar-db)
     - Web service (chefgabbar)

3. **Add environment variables**
   After the services are created, go to your web service settings and add:
   - `STRIPE_SECRET_KEY`: Your Stripe secret key
   - `ALLOWED_HOSTS`: Update if needed (default is `.onrender.com`)

   Note: `SECRET_KEY` and `DATABASE_URL` are automatically generated by Render.

4. **Deploy**
   - Render will automatically deploy your application
   - Wait for the build to complete (this may take 5-10 minutes)
   - Once deployed, you'll get a URL like: `https://chefgabbar.onrender.com`

### Option 2: Manual Setup

1. **Create PostgreSQL Database**
   - Go to Render Dashboard
   - Click "New" â†’ "PostgreSQL"
   - Name: `chefgabbar-db`
   - Choose the free plan (or paid plan if needed)
   - Click "Create Database"
   - Save the "Internal Database URL" for later

2. **Create Web Service**
   - Click "New" â†’ "Web Service"
   - Connect your GitHub repository
   - Configure the service:
     - **Name**: chefgabbar
     - **Runtime**: Python 3
     - **Build Command**: `./build.sh`
     - **Start Command**: `cd chefGabbar && gunicorn chefGabbar.wsgi:application`
     - **Plan**: Free (or upgrade as needed)

3. **Add Environment Variables**
   In the web service settings, add these environment variables:
   - `SECRET_KEY`: Generate a secure key (you can use Django's key generator)
   - `DEBUG`: `False`
   - `ALLOWED_HOSTS`: `.onrender.com`
   - `DATABASE_URL`: Paste the Internal Database URL from step 1
   - `PYTHON_VERSION`: `3.11.0`
   - `STRIPE_SECRET_KEY`: Your Stripe secret key

4. **Deploy**
   - Click "Create Web Service"
   - Render will start building and deploying your app

## Post-Deployment

### Create a Superuser

After your app is deployed, you'll need to create an admin user:

1. Go to your Render dashboard
2. Open your web service
3. Click on the "Shell" tab
4. Run:
   ```bash
   cd chefGabbar
   python manage.py createsuperuser
   ```
5. Follow the prompts to create your admin account

### Access Your Application

- **Main App**: `https://your-app-name.onrender.com`
- **Admin Panel**: `https://your-app-name.onrender.com/admin`

## Important Notes

### Static Files
- Static files are served using WhiteNoise
- They are automatically collected during the build process

### Media Files
- Media files (user uploads) are stored locally on the Render instance
- **Warning**: On the free plan, media files will be deleted when your service restarts or redeploys
- For persistent media storage, consider upgrading to a paid plan or using cloud storage (AWS S3, Cloudinary, etc.)

### Database Backups
- Render provides automatic backups on paid database plans
- For free plans, consider manual backups using `pg_dump`

### Free Plan Limitations
- Services spin down after 15 minutes of inactivity
- First request after spindown may take 30-50 seconds
- 750 hours/month of runtime (good for demo/testing)

## Troubleshooting

### Build Fails
- Check the build logs in Render dashboard
- Ensure `build.sh` has executable permissions (should be set in git)
- Verify all dependencies in `requirements.txt` are correct

### Application Errors
- Check the logs in Render dashboard
- Verify all environment variables are set correctly
- Ensure `DEBUG=False` in production
- Check database connection (DATABASE_URL)

### Static Files Not Loading
- Verify `python manage.py collectstatic` runs successfully in build logs
- Check that WhiteNoise is properly configured in settings.py
- Ensure `STATIC_ROOT` is set correctly

### Database Connection Issues
- Verify `DATABASE_URL` is correctly set
- Check that the database service is running
- Ensure the web service can access the database (internal connection)

## Updating Your Application

To deploy updates:

1. Make your changes locally
2. Commit and push to GitHub:
   ```bash
   git add .
   git commit -m "Your update message"
   git push origin main
   ```
3. Render will automatically detect the changes and redeploy

## Security Checklist

- âœ… `DEBUG=False` in production
- âœ… `SECRET_KEY` is environment variable (not hardcoded)
- âœ… `ALLOWED_HOSTS` is properly configured
- âœ… HTTPS enabled (automatic on Render)
- âœ… Database credentials are secure
- âœ… Stripe secret key is kept secret

## Support

- Render Documentation: https://render.com/docs
- Django Deployment: https://docs.djangoproject.com/en/4.2/howto/deployment/
- Render Community: https://community.render.com/

---

Good luck with your deployment! ðŸš€
