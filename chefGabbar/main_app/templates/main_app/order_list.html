{% extends 'base.html' %}

{% block content %}
{% comment %} This view is for Manager / Superuser {% endcomment %}
{% if user.is_superuser %}
<h1>Order list </h1>
{% for order in order_list %}

<h3>Ordered by {{order.bucket.user.username.capitalize}} at {{order.created_at}} </h3>
<h4>Service : {{order.bucket.get_service_type_display}}</h4>
    <h4>Cart:</h4>
    <ul>
      {% for item in order.bucket.items.all %}
        <li>{{ item.name }} ({{ item.price }} BHD)</li>
      {% endfor %}
    </ul>
    <p>Total = {{order.bucket.total_price}} BHD </p>

<p>Status: {{order.get_status_display}}</p>
<form method='post' action="{% url 'status_update' order.id %}">
  {% csrf_token %}
  {{form.as_p}}
  <button type= 'submit' >Change Status</button>
</form>


{% endfor %}

{% else %}
{% comment %} For Customer View  {% endcomment %}

<h1>Cart</h1>

{% for order in order_list %}
  {% if order.bucket.user == request.user %}
    <h3>Status : {{order.get_status_display}}
    <ul>
    {% for item in order.bucket.items.all %}
      <li>{{ item.name }} - {{ item.price }} BHD</li>
    {% endfor %}
    </ul>

<p>Total = {{order.bucket.total_price}} BHD </p>
<p>Service : {{order.bucket.get_service_type_display}}


      {% endif %}
{% endfor %}


{% endif %}
{% endblock %}
